/*
 * Copyright 2018-2020 Amazon.com, Inc. or its affiliates. All rights reserved.
 *
 * AMAZON PROPRIETARY/CONFIDENTIAL
 *
 * You may not use this file except in compliance with the terms and
 * conditions set forth in the accompanying LICENSE.TXT file.
 *
 * THESE MATERIALS ARE PROVIDED ON AN "AS IS" BASIS. AMAZON SPECIFICALLY
 * DISCLAIMS, WITH RESPECT TO THESE MATERIALS, ALL WARRANTIES, EXPRESS,
 * IMPLIED, OR STATUTORY, INCLUDING THE IMPLIED WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT.
 */
/**
 * @file osal_rand.h
 * @addtogroup ACE_OSAL_RAND
 * @{
 */
#ifndef OSAL_RAND_H
#define OSAL_RAND_H

#include <stdbool.h>
#include <stddef.h>
#include <stdint.h>

#include <ace/ace_status.h>

#ifdef __cplusplus
extern "C" {
#endif

/**
 * @name Random number generator flags
 * @brief Bitmask flags for use with @ref aceRand_get.
 * @{
 */
/**
 * @brief Generate high quality pseudo-random numbers suitable for cryptographic
 *        operations.
 */
#define OSAL_RAND_STRONG_RANDOM 1

/**
 * @brief Ensure that the operation is thread-safe.
 * @deprecated Thread safe by default
 */
#define OSAL_RAND_THREAD_SAFE 2

/**
 * @brief Don't block if sufficient entropy isn't available.
 * @deprecated Non-blocking where supported by default.
 */
#define OSAL_RAND_NONBLOCKING 4
/* @} */

/**
 * @brief   Get pseudo-random bytes.
 * @details Stores `n` pseudo-random bytes to the buffer pointed to by `output`.
 *
 * @param[out] output Pointer to a buffer to store the generated bytes.
 * @param[in]  n      The number of bytes to be written to `output`.
 * @param[in]  flags  A bitmask of `OSAL_RAND` flags.
 *
 * @return ACE_STATUS_OK on success, or an error otherwise.
 */
ace_status_t aceRand_get(uint8_t* output, uint32_t n, int flags);

#ifdef __cplusplus
}
#endif

/** @} */
#endif /* OSAL_RAND_H */
